import pyodbc
import pandas as pd

# Database connection parameters
server = 'your_server_name'
database = 'your_database_name'
username = 'your_username'
password = 'your_password'

# Establish database connection
conn_str = f'DRIVER={{SQL Server}};SERVER={server};DATABASE={database};UID={username};PWD={password}'
conn = pyodbc.connect(conn_str)

# Excel files to be imported
excel_files = ['courses.xlsx', 'users.xlsx', 'enrollments.xlsx', 'assessments.xlsx', 'transactions.xlsx']

# Import Excel files to SQL Server
for file in excel_files:
    # Read Excel file into DataFrame
    df = pd.read_excel(file)
    
    # Define table name
    table_name = file.split('.')[0]
    
    # Write DataFrame to SQL Server
    df.to_sql(table_name, conn, if_exists='replace', index=False)

# Close database connection
conn.close()

print("Data imported successfully from Excel to SQL Server.")
